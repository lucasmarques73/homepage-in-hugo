version: '3'

services:
  hugo:
    build: .
    volumes:
      - ./blog:/var/www/html/blog
      - ./entrypoint.sh:/var/www/html/blog/entrypoint.sh
    ports:
      - 1313:1313
    restart: unless-stopped
    entrypoint: /bin/sh /var/www/html/blog/entrypoint.sh
  homepage:
    image: nginx:1.15.2-alpine
    volumes:
      - ./blog/public:/var/www/html/blog
      - ./nginx/homepage.conf:/etc/nginx/conf.d/default.conf
    ports:
      - 80:80
    depends_on:
      - hugo